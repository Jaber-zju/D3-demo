{"ast":null,"code":"var _class,\n    _temp,\n    _jsxFileName = \"/Volumes/Macintosh HD - \\u6570\\u636E/yu01/d3_ex/src/barChart_2.jsx\";\n\nimport React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport { observer } from \"mobx-react\";\n\nlet BarChart_2 = observer(_class = (_temp = class BarChart_2 extends Component {\n  constructor(props) {\n    super(props);\n\n    this.timer = () => {\n      setInterval(() => {\n        d3.select(\"svg\").remove();\n        this.drawChart(this.props.chartState.dataSet);\n        this.props.chartState.changeData();\n      }, 3000);\n    };\n\n    this.chartState = this.props.chartState;\n  }\n\n  drawChart(data) {\n    const padding = this.chartState.padding;\n    const height = this.chartState.height;\n    const width = this.chartState.width; //x轴宽度\n\n    let xAxisWidth = 300; //y轴宽度\n\n    let yAxisWidth = 300;\n    const xScale = d3.scaleBand().domain(d3.range(0, data.length)).range([0, xAxisWidth]);\n    const yScale = d3.scaleLinear().domain([0, d3.max(data)]).range([0, yAxisWidth]);\n    const svg = d3.select(\"body\").append(\"svg\").attr(\"width\", this.chartState.width).attr(\"height\", this.chartState.height).style('padding-left', padding.left).style('padding-bottom', padding.bottom);\n    const bars = svg.selectAll('rect').data(data).enter().append('rect');\n    bars.attr(\"x\", (d, i) => padding.left + xScale(i)).attr('y', (d, i) => this.chartState.height - padding.bottom - yScale(d)).attr('width', xScale.bandwidth()).attr('height', (d, i) => yScale(d)).attr('fill', 'green').on('mouseover', function () {\n      d3.select(this).style('fill', 'orange');\n      let xPosition = parseFloat(d3.select(this).attr(\"x\")) + width / data.length / 2;\n      let yPosition = parseFloat(d3.select(this).attr(\"y\")) / 2 + height / 2;\n      d3.select('#tooltip').style('left', xPosition).style('top', yPosition).select('#value').text(d => d);\n      d3.select('#tooltip').classed('hidden', false);\n    });\n    const text = svg.selectAll('text').data(data).enter().append('text');\n    text.text((d, i) => d).attr('fill', 'blue').attr(\"font-size\", 12).attr(\"text-anchor\", \"middle\").attr('x', (d, i) => padding.left + xScale(i) + 15).attr('y', (d, i) => this.chartState.height - padding.bottom - yScale(d) - 5);\n    const xAxis = d3.axisBottom(xScale);\n    svg.append(\"g\").attr(\"transform\", (d, i) => \"translate(\" + padding.left + \",\" + (this.chartState.height - padding.bottom) + \")\").call(xAxis);\n    yScale.range([yAxisWidth, 0]);\n    const yAxis = d3.axisLeft(yScale);\n    svg.append(\"g\").attr(\"transform\", \"translate(\" + padding.left + \",\" + (height - padding.bottom - yAxisWidth) + \")\").call(yAxis);\n  }\n\n  componentDidMount() {\n    this.timer();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"tooltip\",\n      className: \"hidden\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 12\n      }\n    }, \"Important Label Heading\")), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      id: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 12\n      }\n    })));\n  }\n\n}, _temp)) || _class;\n\nexport default BarChart_2;","map":{"version":3,"sources":["/Volumes/Macintosh HD - 数据/yu01/d3_ex/src/barChart_2.jsx"],"names":["React","Component","d3","observer","BarChart_2","constructor","props","timer","setInterval","select","remove","drawChart","chartState","dataSet","changeData","data","padding","height","width","xAxisWidth","yAxisWidth","xScale","scaleBand","domain","range","length","yScale","scaleLinear","max","svg","append","attr","style","left","bottom","bars","selectAll","enter","d","i","bandwidth","on","xPosition","parseFloat","yPosition","text","classed","xAxis","axisBottom","call","yAxis","axisLeft","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport * as d3 from \"d3\";\nimport {observer} from \"mobx-react\";\n\n@observer\nclass BarChart_2 extends Component {\n  constructor(props) {\n    super(props)\n    this.chartState = this.props.chartState\n  }\n\n  drawChart(data) {\n    const padding = this.chartState.padding\n    const height = this.chartState.height\n    const width = this.chartState.width\n\n    //x轴宽度\n    let xAxisWidth = 300;\n    //y轴宽度\n    let yAxisWidth = 300;\n\n    const xScale = d3.scaleBand()\n      .domain(d3.range(0, data.length))\n      .range([0, xAxisWidth])\n\n    const yScale = d3.scaleLinear()\n      .domain([0, d3.max(data)])\n      .range([0, yAxisWidth])\n\n    const svg = d3.select(\"body\")\n                  .append(\"svg\")\n                  .attr(\"width\", this.chartState.width)\n                  .attr(\"height\", this.chartState.height)\n                  .style('padding-left', padding.left)\n                  .style('padding-bottom', padding.bottom)\n\n    const bars = svg.selectAll('rect').data(data).enter().append('rect')\n    bars.attr(\"x\", (d, i) => padding.left + xScale(i))\n        .attr('y', (d, i) => this.chartState.height - padding.bottom - yScale(d))\n        .attr('width', xScale.bandwidth())\n        .attr('height', (d, i) => yScale(d))\n        .attr('fill', 'green')\n        .on('mouseover', function() {\n          d3.select(this).style('fill', 'orange')\n          let xPosition = parseFloat(d3.select(this).attr(\"x\")) + (width/data.length) / 2;\n          let yPosition = parseFloat(d3.select(this).attr(\"y\")) / 2 + height / 2;\n\n          d3.select('#tooltip')\n            .style('left', xPosition)\n            .style('top', yPosition)\n            .select('#value')\n            .text(d => d)\n\n          d3.select('#tooltip').classed('hidden', false)\n        })\n\n    const text = svg.selectAll('text').data(data).enter().append('text')\n    text.text((d, i) => d)\n        .attr('fill', 'blue')\n        .attr(\"font-size\", 12)\n        .attr(\"text-anchor\",\"middle\")\n        .attr('x', (d, i) => padding.left + xScale(i) + 15)\n        .attr('y', (d, i) => this.chartState.height - padding.bottom - yScale(d) - 5)\n\n\n    const xAxis = d3.axisBottom(xScale)\n    svg.append(\"g\")\n      .attr(\"transform\",(d, i) => \"translate(\" + padding.left + \",\" + (this.chartState.height - padding.bottom) + \")\")\n      .call(xAxis)\n\n    yScale.range([yAxisWidth, 0])\n    const yAxis = d3.axisLeft(yScale)\n\n    svg.append(\"g\")\n      .attr(\"transform\",\"translate(\" + (padding.left) + \",\" + (height - padding.bottom - yAxisWidth) + \")\")\n      .call(yAxis)\n  }\n\n  timer = () => {\n    setInterval(() => {\n      d3.select(\"svg\").remove()\n      this.drawChart(this.props.chartState.dataSet)\n      this.props.chartState.changeData()\n    }, 3000)\n  }\n\n  componentDidMount() {\n    this.timer()\n  }\n  render() {\n    return (\n      <div id=\"tooltip\" className=\"hidden\">\n        <p><strong>Important Label Heading</strong></p>\n        <p><span id=\"value\"></span></p>\n      </div>\n    )\n  }\n}\n\nexport default BarChart_2\n"]},"metadata":{},"sourceType":"module"}